//
//  WeatherAppTests.swift
//  WeatherAppTests
//
//  Created by Danila Sidukov on 03.02.2024.
//

import XCTest
@testable import WeatherApp

final class WeatherAppTests: XCTestCase {

    func testParseJson() {
        let jsonStr = """
            {"summary":{"query":"москва","queryType":"NON_NEAR","queryTime":59,"numResults":10,"offset":0,"totalResults":167,"fuzzyLevel":1},"results":[{"type":"Geography","id":"Q1MMPHFBkot1TrgEuRRdaw","score":2.5820579529,"entityType":"Municipality","matchConfidence":{"score":1},"address":{"municipality":"Москва","countrySecondarySubdivision":"Москва","countryTertiarySubdivision":"Москва","countrySubdivision":"Центральный федеральный округ","countrySubdivisionName":"Центральный федеральный округ","countryCode":"RU","country":"Россия","countryCodeISO3":"RUS","freeformAddress":"Москва"},"position":{"lat":55.7565408,"lon":37.6149202},"viewport":{"topLeftPoint":{"lat":56.02125,"lon":36.88782},"btmRightPoint":{"lat":55.49275,"lon":37.96747}},"boundingBox":{"topLeftPoint":{"lat":56.021251,"lon":36.887816},"btmRightPoint":{"lat":55.492753,"lon":37.967469}},"dataSources":{"geometry":{"id":"00005858-5800-1200-0000-00007d2ca98e"}}},{"type":"Geography","id":"dFSK4G0jf-JgU68MV50h5Q","score":2.3817019463,"entityType":"Municipality","matchConfidence":{"score":1},"address":{"municipality":"Москва","countrySecondarySubdivision":"Мир Сайид Алии Ҳамадонӣ","countrySubdivision":"Хатлон","countrySubdivisionName":"Хатлон","countrySubdivisionCode":"KT","countryCode":"TJ","country":"Тоҷикистон","countryCodeISO3":"TJK","freeformAddress":"Москва Мир Сайид Алии Ҳамадонӣ, Хатлон"},"position":{"lat":37.6556196,"lon":69.6285824},"viewport":{"topLeftPoint":{"lat":37.67208,"lon":69.60912},"btmRightPoint":{"lat":37.63494,"lon":69.65369}},"boundingBox":{"topLeftPoint":{"lat":37.672079,"lon":69.609118},"btmRightPoint":{"lat":37.634938,"lon":69.653691}},"dataSources":{"geometry":{"id":"bcee2e5e-5691-4813-b33e-2dd3f8b07154"}}},{"type":"Geography","id":"i4uHCHyzjuDGqS2S0ZYSJw","score":2.3586277962,"entityType":"Municipality","matchConfidence":{"score":0.950180478536626},"address":{"municipality":"Москва району","countrySecondarySubdivision":"Москва району","countrySubdivision":"Чуй облусу","countrySubdivisionName":"Чуй облусу","countrySubdivisionCode":"C","countryCode":"KG","country":"Кыргызстан","countryCodeISO3":"KGZ","freeformAddress":"Москва району, Чуй облусу"},"position":{"lat":42.7618107,"lon":74.0792384},"viewport":{"topLeftPoint":{"lat":43.19365,"lon":73.90753},"btmRightPoint":{"lat":42.35932,"lon":74.25111}},"boundingBox":{"topLeftPoint":{"lat":43.193654,"lon":73.907532},"btmRightPoint":{"lat":42.359325,"lon":74.251114}},"dataSources":{"geometry":{"id":"e2f32079-e47f-44c9-ba0c-8489b5ad3332"}}},{"type":"Geography","id":"Q4MBOZgh3PN5AjtyfWVZ1A","score":2.1768069267,"entityType":"MunicipalitySubdivision","matchConfidence":{"score":1},"address":{"municipalitySubdivision":"Москва","municipality":"Пеновский","countrySecondarySubdivision":"Тверская область","countryTertiarySubdivision":"Пеновский округ","countrySubdivision":"Центральный федеральный округ","countrySubdivisionName":"Центральный федеральный округ","countryCode":"RU","country":"Россия","countryCodeISO3":"RUS","freeformAddress":"Москва, Пеновский"},"position":{"lat":56.917452,"lon":32.1654774},"viewport":{"topLeftPoint":{"lat":56.92025,"lon":32.15904},"btmRightPoint":{"lat":56.91421,"lon":32.17225}},"boundingBox":{"topLeftPoint":{"lat":56.920245,"lon":32.159043},"btmRightPoint":{"lat":56.914213,"lon":32.172253}},"dataSources":{"geometry":{"id":"00005231-3400-3c00-0000-0000270ad8a6"}}},{"type":"Geography","id":"skGwUaQcjy09RZumBc8tgg","score":2.1768069267,"entityType":"MunicipalitySubdivision","matchConfidence":{"score":1},"address":{"municipalitySubdivision":"Москва","municipality":"Славковская","countrySecondarySubdivision":"Псковская область","countryTertiarySubdivision":"Порховский район","countrySubdivision":"Северо-Западный Федеральный Округ","countrySubdivisionName":"Северо-Западный Федеральный Округ","countryCode":"RU","country":"Россия","countryCodeISO3":"RUS","freeformAddress":"Москва, Славковская"},"position":{"lat":57.4486553,"lon":29.1858734},"viewport":{"topLeftPoint":{"lat":57.44962,"lon":29.18481},"btmRightPoint":{"lat":57.44771,"lon":29.18681}},"boundingBox":{"topLeftPoint":{"lat":57.449624,"lon":29.184807},"btmRightPoint":{"lat":57.447708,"lon":29.18681}},"dataSources":{"geometry":{"id":"8358d8f1-a632-4647-b7ec-39d8525c3ad3"}}},{"type":"Geography","id":"mZQUqWTfWl3s4WGFP2v9xA","score":2.1554658413,"entityType":"MunicipalitySubdivision","matchConfidence":{"score":0.8678203543273949},"address":{"municipalitySubdivision":"Менеуз-Москва","municipality":"Кош-Елгинский","countrySecondarySubdivision":"Башкортостан республика","countryTertiarySubdivision":"Бижбулякский район","countrySubdivision":"Приволжский Федеральный Округ","countrySubdivisionName":"Приволжский Федеральный Округ","countryCode":"RU","country":"Россия","countryCodeISO3":"RUS","freeformAddress":"Менеуз-Москва, Кош-Елгинский"},"position":{"lat":53.8751605,"lon":54.3197461},"viewport":{"topLeftPoint":{"lat":53.88529,"lon":54.31117},"btmRightPoint":{"lat":53.86838,"lon":54.32518}},"boundingBox":{"topLeftPoint":{"lat":53.885295,"lon":54.311175},"btmRightPoint":{"lat":53.868375,"lon":54.32518}},"dataSources":{"geometry":{"id":"a836eae9-eed8-4580-b343-2e65c085ef38"}}},{"type":"Geography","id":"vx3lyUcn-qidBerCCFl6ig","score":2.1554658413,"entityType":"MunicipalitySubdivision","matchConfidence":{"score":0.9053548237724877},"address":{"municipalitySubdivision":"Новая Москва","municipality":"Красная Гора","countrySecondarySubdivision":"Брянская область","countryTertiarySubdivision":"Красногорский район","countrySubdivision":"Центральный федеральный округ","countrySubdivisionName":"Центральный федеральный округ","countryCode":"RU","country":"Россия","countryCodeISO3":"RUS","freeformAddress":"Новая Москва, Красная Гора"},"position":{"lat":53.0155733,"lon":31.55256},"viewport":{"topLeftPoint":{"lat":53.019,"lon":31.54767},"btmRightPoint":{"lat":53.0128,"lon":31.55484}},"boundingBox":{"topLeftPoint":{"lat":53.018998,"lon":31.547666},"btmRightPoint":{"lat":53.012801,"lon":31.554839}},"dataSources":{"geometry":{"id":"00005231-3400-3c00-0000-0000270af49a"}}},{"type":"Geography","id":"zT1v91PWdFAvFXiIeaHffw","score":2.1554658413,"entityType":"MunicipalitySubdivision","matchConfidence":{"score":0.9420884469939967},"address":{"municipalitySubdivision":"СНТ Москва","municipality":"Орехово-Зуево","countrySecondarySubdivision":"Московская область","countryTertiarySubdivision":"Орехово-Зуево","countrySubdivision":"Центральный федеральный округ","countrySubdivisionName":"Центральный федеральный округ","countryCode":"RU","country":"Россия","countryCodeISO3":"RUS","freeformAddress":"СНТ Москва, Орехово-Зуево"},"position":{"lat":55.5317981,"lon":38.9303162},"viewport":{"topLeftPoint":{"lat":55.53377,"lon":38.92642},"btmRightPoint":{"lat":55.53025,"lon":38.93335}},"boundingBox":{"topLeftPoint":{"lat":55.53377,"lon":38.926424},"btmRightPoint":{"lat":55.530247,"lon":38.933353}},"dataSources":{"geometry":{"id":"a689f2ae-368f-4cd4-a62e-6bcdecf4de43"}}},{"type":"Geography","id":"bxXZaNbwhw1_SvdGOQYLCA","score":2.1554658413,"entityType":"MunicipalitySubdivision","matchConfidence":{"score":0.9053548237724877},"address":{"municipalitySubdivision":"Новая Москва","municipality":"Тольско-Майданский","countrySecondarySubdivision":"Нижегородская область","countryTertiarySubdivision":"Лукояновский район","countrySubdivision":"Приволжский Федеральный Округ","countrySubdivisionName":"Приволжский Федеральный Округ","countryCode":"RU","country":"Россия","countryCodeISO3":"RUS","freeformAddress":"Новая Москва, Тольско-Майданский"},"position":{"lat":54.8655801,"lon":44.5151255},"viewport":{"topLeftPoint":{"lat":54.86706,"lon":44.50587},"btmRightPoint":{"lat":54.86349,"lon":44.52309}},"boundingBox":{"topLeftPoint":{"lat":54.867063,"lon":44.505868},"btmRightPoint":{"lat":54.863489,"lon":44.523088}},"dataSources":{"geometry":{"id":"00005231-3100-3c00-0000-00002671faa6"}}},{"type":"Geography","id":"2M7HcCuJzN2ZbdH1JD6SDg","score":2.1345388889,"entityType":"MunicipalitySubdivision","matchConfidence":{"score":0.8453420507421309},"address":{"municipalitySubdivision":"СНТ АСУ Москва","municipality":"Сергиев Посад","countrySecondarySubdivision":"Московская область","countryTertiarySubdivision":"Сергиев Посад","countrySubdivision":"Центральный федеральный округ","countrySubdivisionName":"Центральный федеральный округ","countryCode":"RU","country":"Россия","countryCodeISO3":"RUS","freeformAddress":"СНТ АСУ Москва, Сергиев Посад"},"position":{"lat":56.2808889,"lon":38.2338038},"viewport":{"topLeftPoint":{"lat":56.28293,"lon":38.23257},"btmRightPoint":{"lat":56.27863,"lon":38.2392}},"boundingBox":{"topLeftPoint":{"lat":56.282932,"lon":38.232574},"btmRightPoint":{"lat":56.278626,"lon":38.239195}},"dataSources":{"geometry":{"id":"00005231-3200-3c00-0000-0000240f9c94"}}}]}
            """

        let jsonData = Data(jsonStr.utf8)

        do {
            let model = try JSONDecoder().decode(GeocodingData.self, from: jsonData)
            print(model)
        } catch {
            print("Error: \(error)")
        }
    }

}
